<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Presupuesto Ebanistería - RD$</title>
    <style>
        :root {
            --primary: #5d4037;
            --secondary: #d7ccc8;
            --accent: #8d6e63;
            --bg: #f5f5f5;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background: var(--white);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .section {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        h2 {
            font-size: 1.2rem;
            color: var(--accent);
            margin-top: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }

        th,
        td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn:hover {
            background-color: var(--accent);
        }

        .delete-btn {
            background-color: #e57373;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .totals-panel {
            background: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .grand-total {
            font-size: 1.6rem;
            font-weight: bold;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            padding-top: 10px;
            margin-top: 10px;
        }

        .help-text {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 10px;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Cotizador de Ebanistería (RD$)</h1>

        <div class="section">
            <h2>1. Madera Maciza (Pies Tablares)</h2>
            <p class="help-text">Cálculo: (Grosor" x Ancho" x Largo") / 12</p>
            <table id="tablaMadera">
                <thead>
                    <tr>
                        <th>Descripción</th>
                        <th>Pies Tablares</th>
                        <th>Precio x Pie (RD$)</th>
                        <th>Total</th>
                        <th>Acción</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="Ej: Caoba"></td>
                        <td><input type="number" class="qty" value="0" oninput="calcular()"></td>
                        <td><input type="number" class="price" value="0" oninput="calcular()"></td>
                        <td class="subtotal">0.00</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <button class="btn" onclick="agregarFila('tablaMadera')">+ Agregar Madera</button>
        </div>

        <div class="section">
            <h2>2. Herrajes y Terminación</h2>
            <table id="tablaMateriales">
                <thead>
                    <tr>
                        <th>Material</th>
                        <th>Cantidad</th>
                        <th>Precio Unit. (RD$)</th>
                        <th>Total</th>
                        <th>Acción</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="Ej: Barniz, Cola, Lija"></td>
                        <td><input type="number" class="qty" value="0" oninput="calcular()"></td>
                        <td><input type="number" class="price" value="0" oninput="calcular()"></td>
                        <td class="subtotal">0.00</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <button class="btn" onclick="agregarFila('tablaMateriales')">+ Agregar Insumo</button>
        </div>

        <div class="section">
            <h2>3. Mano de Obra y Ganancia</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <label>Mano de Obra Directa (RD$):</label>
                    <input type="number" id="manoObra" value="0" oninput="calcular()">
                </div>
                <div>
                    <label>Margen de Beneficio (%):</label>
                    <input type="number" id="margen" value="30" oninput="calcular()">
                </div>
            </div>
        </div>

        <div class="totals-panel">
            <div class="total-row">
                <span>Costo Total de Materiales:</span>
                <span id="resMateriales">RD$ 0.00</span>
            </div>
            <div class="total-row">
                <span>Mano de Obra:</span>
                <span id="resManoObra">RD$ 0.00</span>
            </div>
            <div class="total-row">
                <span>Subtotal Costo:</span>
                <span id="resSubtotal">RD$ 0.00</span>
            </div>
            <div class="total-row">
                <span>Margen de Ganancia:</span>
                <span id="resGanancia">RD$ 0.00</span>
            </div>
            <div class="total-row grand-total">
                <span>PRECIO FINAL SUGERIDO:</span>
                <span id="resTotal">RD$ 0.00</span>
            </div>
        </div>

        <p style="text-align: center; margin-top: 20px;">
            <button class="btn" onclick="window.print()">Imprimir Cotización</button>
        </p>
    </div>

    <script>
        function agregarFila(idTabla) {
            const tabla = document.getElementById(idTabla).getElementsByTagName('tbody')[0];
            const nuevaFila = tabla.insertRow();
            nuevaFila.innerHTML = `
            <td><input type="text"></td>
            <td><input type="number" class="qty" value="0" oninput="calcular()"></td>
            <td><input type="number" class="price" value="0" oninput="calcular()"></td>
            <td class="subtotal">0.00</td>
            <td><button class="delete-btn" onclick="eliminarFila(this)">Eliminar</button></td>
        `;
        }

        function eliminarFila(btn) {
            const fila = btn.parentNode.parentNode;
            fila.parentNode.removeChild(fila);
            calcular();
        }

        function calcular() {
            let totalMateriales = 0;

            // Calcular todas las filas de todas las tablas
            const filas = document.querySelectorAll('tr');
            filas.forEach(fila => {
                const qty = fila.querySelector('.qty');
                const price = fila.querySelector('.price');
                const subtotalCell = fila.querySelector('.subtotal');

                if (qty && price) {
                    const sub = parseFloat(qty.value || 0) * parseFloat(price.value || 0);
                    subtotalCell.innerText = sub.toLocaleString('en-US', { minimumFractionDigits: 2 });
                    totalMateriales += sub;
                }
            });

            const manoObra = parseFloat(document.getElementById('manoObra').value || 0);
            const margenPorcentaje = parseFloat(document.getElementById('margen').value || 0) / 100;

            const subtotalCosto = totalMateriales + manoObra;
            const ganancia = subtotalCosto * margenPorcentaje;
            const totalFinal = subtotalCosto + ganancia;

            // Actualizar UI
            document.getElementById('resMateriales').innerText = "RD$ " + totalMateriales.toLocaleString('en-US', { minimumFractionDigits: 2 });
            document.getElementById('resManoObra').innerText = "RD$ " + manoObra.toLocaleString('en-US', { minimumFractionDigits: 2 });
            document.getElementById('resSubtotal').innerText = "RD$ " + subtotalCosto.toLocaleString('en-US', { minimumFractionDigits: 2 });
            document.getElementById('resGanancia').innerText = "RD$ " + ganancia.toLocaleString('en-US', { minimumFractionDigits: 2 });
            document.getElementById('resTotal').innerText = "RD$ " + totalFinal.toLocaleString('en-US', { minimumFractionDigits: 2 });
        }
    </script>

</body>

</html>